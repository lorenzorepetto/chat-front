<div class="chat-right-aside">
    <div class="chat-main-header">
        <div *ngIf="user && chatService.currentRoom$ | async as current; else loadingHeader" class="p-20 b-b">
            <h2>{{ user.name }}</h2>
            <div class="row mb-0 pb-0" >
                <div class="col">
                    <h5 *ngIf="user.status === 'ONLINE'" class="text-success">Disponible</h5>
                    <h5 *ngIf="user.status === 'BUSY'" class="text-warning">No disponible</h5>
                </div>
                <div class="col">
                    <h6 class="d-inline mr-3">Cambiar estado a: </h6>
                    <button (click)="changeStatus('ONLINE')" *ngIf="user.status === 'BUSY'" class="btn btn-rounded btn-primary">Disponible</button>
                    <button (click)="changeStatus('BUSY')" *ngIf="user.status === 'ONLINE'" class="btn btn-rounded btn-warning">Ocupado</button>
                </div>
            </div>
            <h2 class="box-title mt-2 p-3">
                <small>Sala </small>{{ current.name | titlecase}}
            </h2>
            <ng-template #loadingHeader>
                <i class="fa fa-spinner fa-spin"></i>
                Cargando
            </ng-template>
        </div>
    </div>

    <div class="chat-rbox" id="chat-messages">
        <ul *ngIf="messages" class="chat-list p-20" id="divChatbox">
            <!--chat Row -->
            <li *ngFor="let message of messages" [ngClass]="{'reverse': user && user.email === message.user.email}">
                <!-- Propio -->
                <div *ngIf="message && user.email !== message.user.email">
                    <div class="chat-img"><img *ngIf="message.user.picture" [attr.src]="message.user.picture" [alt]="message.user.name" /></div>
                    <div class="chat-content">
                        <h5>{{ message.user.name }}</h5>
                        <div class="box bg-light-info">{{ message.text }}</div>
                    </div>
                    <div class="chat-time">{{ message.date | date }}</div>
                </div>

                <!-- Otro -->
                <div *ngIf="message && user.email === message.user.email">
                    <div class="chat-content">
                        <h5>{{ user.name }}</h5>
                        <div class="box bg-light-inverse">{{ message.text }}</div>
                    </div>
                    <div class="chat-img"><img *ngIf="user.picture" [attr.src]="user.picture" [alt]="user.name" /></div>
                    <div class="chat-time">{{ message.date | date }}</div>
                </div>
            </li>
            <!--chat Row -->
            <ng-template #loading>Cargando</ng-template>
        </ul>
    </div>
    <div class="card-body b-t">
        <form (ngSubmit)="send()">
            <div class="row">
                <div class="col-8">
                    <input  [disabled]="!user || !room"
                            name="text"
                            [(ngModel)]="text"
                            placeholder="Escribe tu mensaje aquÃ­" 
                            class="form-control b-0"
                            autofocus
                            autocomplete="false">
                    <!-- </textarea> -->
                </div>
                <div class="col-4 text-right">
                    <button [disabled]="!user || !room" type="submit" class="btn btn-info btn-circle btn-lg">
                        <i class="fa fa-paper-plane-o"></i> 
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>