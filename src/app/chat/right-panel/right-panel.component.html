<div class="chat-right-aside">
    <div class="chat-main-header">
        <div *ngIf="user && chatService.currentRoom$ | async as current; else loadingHeader" class="p-20 b-b">
            <h2>
                <i class="fa fa-user"></i>
                {{ user.name }}
            </h2>
            <div class="row mb-0 pb-0" >
                <div class="col">
                    <h5 *ngIf="user.status === 'ONLINE'" class="text-success">Disponible</h5>
                    <h5 *ngIf="user.status === 'BUSY'" class="text-warning">Ocupado</h5>
                </div>
                <div class="col">
                    <h6 class="d-inline mr-3">Cambiar estado a: </h6>
                    <button (click)="changeStatus('ONLINE')" *ngIf="user.status === 'BUSY'" class="btn btn-rounded btn-primary">Disponible</button>
                    <button (click)="changeStatus('BUSY')" *ngIf="user.status === 'ONLINE'" class="btn btn-rounded btn-warning">Ocupado</button>
                </div>
            </div>
            <h2 class="box-title p-3">
                <small>Sala: </small>
                <span class="badge badge-pill badge-primary ml-2">{{ current.name | titlecase}}</span>
            </h2>
            <ng-template #loadingHeader>
                <i class="fa fa-spinner fa-spin"></i>
                Cargando
            </ng-template>
        </div>
    </div>

    <div class="chat-rbox">
        <ol *ngIf="messages; else loadingMessages" class="chat-list p-20" #scrollMe [scrollTop]="scrollMe.scrollHeight">
            <!--chat Row -->
            <li *ngFor="let message of messages" [ngClass]="{'reverse': user && user.email === message.user.email}">
                <!-- Otro -->
                <div class="row" *ngIf="message && user.email !== message.user.email">
                    <div class="chat-img"><img *ngIf="message.user.picture" [attr.src]="message.user.picture" [alt]="message.user.name" /></div>
                    <div class="chat-content">
                        <h5>{{ message.user.name }}</h5>
                        <div class="box bg-light-info chat-message">{{ message.text }}</div>
                    </div>
                    <div class="chat-time p-2">{{ message.date | date:'MMM d, h:mm a' }}</div>
                </div>

                <!-- Propio -->
                <div class="row" *ngIf="message && user.email === message.user.email">
                    
                    <div class="col text-left">
                        <div (click)="remove(message)" alt="Eliminar mensaje" class="trash">
                            <i class="fa fa-trash"></i>
                        </div>
                    </div>
                    <div>
                        <div class="chat-content">
                            <h5>{{ user.name }}</h5>
                            <div class="box bg-light-inverse chat-message">{{ message.text }}</div>
                        </div>
                        <div class="chat-img"><img *ngIf="user.picture" [attr.src]="user.picture" [alt]="user.name" /></div>
                        <div class="chat-time p-2">{{ message.date | date:'MMM d, h:mm a' }}</div>
                    </div>
                </div>
            </li>
            <!--chat Row -->
        </ol>
        <ng-template #loadingMessages>
            <i class="fa fa-spinner fa-spin"></i>
            Cargando
        </ng-template>
    </div>
    <div class="card-body b-t">
        <form (ngSubmit)="send()">
            <div class="row">
                <div class="col-8">
                    <input  [disabled]="!user || !room"
                            name="text"
                            [(ngModel)]="text"
                            placeholder="Escribe tu mensaje aquÃ­" 
                            class="form-control b-0"
                            autofocus
                            autocomplete="off"
                            maxlength="100">
                    <!-- </textarea> -->
                </div>
                <div class="col-4 text-right">
                    <button [disabled]="!user || !room" type="submit" class="btn btn-info btn-circle btn-lg">
                        <i class="fa fa-paper-plane-o"></i> 
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>